# WARNING:
# This file is auto-generated by the blueprint plugin template.
# Edit this file with caution.
# DO NOT REMOVE COMMENTS, they are used by the template to update the file with automated edits.

cmake_minimum_required(VERSION 3.15)

# Plugin name
set(PROJECT_NAME --BLUEPRINT--PLUGIN_NAME-- )
project(${PROJECT_NAME})

# Optional Maya version from CLI
if(NOT DEFINED MAYA_VERSION)
  message(FATAL_ERROR "MAYA_VERSION not set.")
endif()

set(CMAKE_CXX_STANDARD 17)

# Include directories
include_directories("${MAYA_DEVKIT_ROOT}/include")

# Library directories
link_directories("${MAYA_DEVKIT_ROOT}/lib")

# Platform-specific settings
if(WIN32)
    add_definitions(-DNOMINMAX -DNT_PLUGIN -D_BOOL)
    set(EXTENSION "mll")
elseif(APPLE)
    add_definitions(-D_BOOL)
    set(EXTENSION "bundle")
else()
    set(EXTENSION "so")
endif()

# Sources
file(GLOB_RECURSE SOURCES "*.cpp")
file(GLOB_RECURSE HEADERS "*.h")

find_package(OpenGL REQUIRED)

# Build plugin
add_library(${PROJECT_NAME} SHARED ${SOURCES} ${HEADERS})

# Link Maya libs
target_link_libraries(${PROJECT_NAME}
    OpenMaya
    OpenMayaRender      # needed for MRenderUtil::sampleShadingNetwork
    OpenMayaUI          # needed for M3dView::active3dView
    Foundation
	OpenMayaAnim
    OpenMayaFX
    Foundation
    OpenGL::GL    # Modern cross-platform way to link OpenGL
    OpenGL::GLU   # Modern cross-platform way to link GLU
)

# Output settings
set_target_properties(${PROJECT_NAME} PROPERTIES
    PREFIX ""
    SUFFIX ".${EXTENSION}"
    LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/src/${PROJECT_NAME}/$<CONFIG>"
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/src/${PROJECT_NAME}/$<CONFIG>"
)
